<aura:component controller="PotionCatalogueController" implements="force:appHostable,flexipage:availableForAllPageTypes,force:hasRecordId" access="global">
    
    <!-- getting All potions, and all PickList Values for the filter -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    
    <!-- populate all of the potions on oninit -->
    <aura:attribute name="potions" type="Potion__c[]"/>
    <aura:attribute name="potions2" type="Potion__c[]"/>
    
    <!-- getting a single potion if add to cart clicked -->
    <aura:attribute name="single" type="Potion__c"/>
    
    
    <!-- for filtering -->
    <aura:attribute name="options" type="String[]" />
    
    <!-- boolean for the success modal -->
    <aura:attribute name="ifSuccess" type="boolean" default="false" />
    
    <!-- events for order and singlePotion -->
    <aura:handler name="regAdd" event="c:addToCartEvent" action="{! c.handleSingleRecord}" />
    <aura:handler name="createOrder" event="c:orderEvent" action="{!c.handleOrder}" />
    
    <!-- TEST -->
    <aura:attribute name="myTest" type="string" default="empty" />
    
    <!-- Johns Setup -->
    
    <!-- Attribute similar if not the same as you single attribute -->  
    <aura:attribute name="potion" type="Potion__c" />
    
    <!-- / Johns Setup -->
    
    <div class="mainDiv">
        
        <!-- HEADER -->
        <div class="header-footer slds-p-vertical_small">
            <h2 >HEADER</h2>   
        </div>  
        <!-- HEADER -->
        
        <!-- SUCCESS MODAL -->
        <aura:if isTrue="{!v.ifSuccess}">  
            <div class="success">
                <p>SUCCESS</p>
                <p>Your order has been placed!</p>
            </div>
        </aura:if>
        <!-- SUCCESS MODAL -->
        
        
        <!-- FILTER -->
        <div class="slds-select_container slds-m-around_large">
            <lightning:select aura:id="selectOne" label="" onchange="{!c.selectedType}" >
                <aura:iteration items="{!v.options}" var="opt" >
                    <option value="{!opt}" style="color:black;" text="{!opt}"></option>
                </aura:iteration>
            </lightning:select> 
        </div>
        <!-- FILTER -->
        
        
        <!-- ALL CARDS IN HERE IF ANY -->
        <div class="{!v.single ? 'slds-hide' : ''}">
            
            <div class="{!v.potion ? 'slds-hide' : ''}">
                
                <div class="slds-grid slds-gutters slds-wrap slds-m-horizontal_small slds-align_absolute-center">
                    <aura:if isTrue="{!not(empty(v.potions))}">
                        <!-- Iterating through the all of the potions, here's going to put a single potion component--> 
                        <aura:iteration items="{!v.potions}" var="potion" >
                            
                            <!-- Added aura:id to be able to target this class for showing and hiding  -->
                            <div aura:id="card" class="slds-col slds-m-bottom_medium slds-m-top_medium slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-3">     
                                <c:singlePotion potion="{!potion}"/>
                            </div>
                            
                        </aura:iteration>    
                        
                        <aura:set attribute="else">
                            
                            <div class="slds-col slds-m-around_xx-large slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_2-of-3 slds-align_absolute-center"> 
                                
                                <lightning:card >
                                    <h2 class="slds-text-align_center slds-text-heading_medium" >Sorry</h2>
                                    <div style="max-width:400px">
                                        <img src="{!$Resource.po404}"/>
                                    </div>
                                    <div class="slds-text-longform">
                                        <h3 class="slds-text-heading_medium slds-align_absolute-center slds-p-top_medium">OUT OF POTIONS</h3><br/>
                                        <p class="slds-text-body_regular slds-align_absolute-center">Please check again later.</p>
                                    </div>
                                </lightning:card>
                            </div>
                            
                        </aura:set> 
                    </aura:if>
                </div>
                
            </div>
            
        </div>
            <!-- ALL CARDS IN HERE-->
            
            
            <!-- MODAL FOR CREATING AN ORDER -->  
            <div class="{! v.single ? '' : 'slds-hide'}">
                <div class="slds-grid" style="display: flex;justify-content: center">
                    <div class="slds-p-around_large slds-m-around_large slds-col slds-size_6-of-12" >
                        <c:order one="{!v.single}" />
                    </div>
                </div>
            </div>       
            <!-- MODAL FOR CREATING AN ORDER -->  
            
            <!-- Aura if for showing / hiding cards -->     
                <aura:if isTrue="{!v.potion}">
                
                <!-- card Detail -->
                <div id="detail-card" class="slds-card slds-m-around_large slds-p-around_large  " style="width:60%">
                    <lightning:card title="{!v.potion.Name}" iconName="utility:recipe" footer="Kraken potions inc">
                        
                        <h1>Type: {!v.potion.Type_of_Potion__c}</h1>
                        <br/>
                        <div class="slds-box slds-box_x-small"><p >Ingredients</p>
                            <p> Base Ingredient: {!v.potion.Base_Ingredient__r.Name}</p>
                            <p>Price: <lightning:formattedNumber value="{!v.potion.Base_Ingredient__r.Ingredient_Price__c}" style="currency"/></p>
                            <br/>
                            <div class="{!v.potion.Secondary_Ingredient__r ? '' : 'slds-hide'}">
                                <p> Secondary Ingredient: {!v.potion.Secondary_Ingredient__r.Name}</p>
                                <p>Price: <lightning:formattedNumber value="{!v.potion.Secondary_Ingredient__r.Ingredient_Price__c}" style="currency"/></p>
                            </div>
                        </div>
                        
                        <div >
                            <aura:if isTrue="{! v.potion.Potion_URL__c}" >
                                <img style="max-width:400px;max-height:600px" src="{! v.potion.Potion_URL__c}" />
                                <aura:set attribute="else">
                                    <img style="max-width:400px;max-height:700px" src="{!$Resource.nopic}" />
                                </aura:set>
                            </aura:if>
                        </div>
                        
                        <br/>
                        <p>Potion Price: <lightning:formattedNumber value="{!v.potion.Total_Price__c}" style="currency"/></p>
                        
                        <lightning:button variant="brand-outline" label="Back" title="Click Me see all Cards" onclick="{!c.handleClose}" class="slds-m-top_large" />

                    </lightning:card>
                </div>
                
            </aura:if>   
            
            <!--- / John's Code -->
            
            <div class="slds-docked-form-footer header-footer slds-p-vertical_small">
                <h2 >Potions Co. 2021 </h2>
            </div>
            
        </div>
    </aura:component>